{"remainingRequest":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\babel-loader\\lib\\index.js!E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Projects\\vue-library-master\\1-Project\\frontend\\src\\shared\\form\\image-upload.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\src\\shared\\form\\image-upload.vue","mtime":1641838499614},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\babel.config.js","mtime":1641838494433},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641838763341},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1641838769328},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641838763341},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1641838768457}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _toConsumableArray from \"E:\\\\Projects\\\\vue-library-master\\\\1-Project\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\toConsumableArray.js\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"E:\\\\Projects\\\\vue-library-master\\\\1-Project\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport _defineProperty from \"E:\\\\Projects\\\\vue-library-master\\\\1-Project\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\defineProperty.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { FileUploader } from '@/shared/file-upload/file-uploader';\nimport Errors from '@/shared/error/errors';\nexport default {\n  name: 'app-image-upload',\n  props: ['path', 'value', 'schema', 'max'],\n  data: function data() {\n    return {\n      dialogImageUrl: '',\n      dialogVisible: false,\n      fileList: (this.value || []).map(function (item) {\n        return _objectSpread(_objectSpread({}, item), {}, {\n          url: item.publicUrl\n        });\n      }),\n      loading: false\n    };\n  },\n  computed: {\n    isFull: function isFull() {\n      var hasInputReference = !!this.$refs.files;\n      return this.max && hasInputReference && this.$refs.files.uploadFiles.length >= this.max || !hasInputReference && (this.value || []).length >= this.max;\n    },\n    accept: function accept() {\n      return 'image/*';\n    }\n  },\n  methods: {\n    uploadFromRequest: function () {\n      var _uploadFromRequest = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(request) {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.loading = true;\n                return _context.abrupt(\"return\", FileUploader.uploadFromRequest(this.path, request, this.schema));\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function uploadFromRequest(_x) {\n        return _uploadFromRequest.apply(this, arguments);\n      }\n\n      return uploadFromRequest;\n    }(),\n    onSuccess: function onSuccess(file) {\n      if (!file) {\n        return;\n      }\n\n      this.$emit('input', [].concat(_toConsumableArray(this.value || []), [file]));\n      this.loading = false;\n    },\n    onError: function onError(error) {\n      Errors.showMessage(error);\n      this.loading = false;\n    },\n    onRemove: function onRemove(file) {\n      if (!file) {\n        return;\n      }\n\n      var id = file.response ? file.response.id : file.id;\n      this.$emit('input', (this.value || []).filter(function (item) {\n        return item.id !== id;\n      }));\n    },\n    handlePictureCardPreview: function handlePictureCardPreview(file) {\n      this.dialogImageUrl = file.url;\n      this.dialogVisible = true;\n    }\n  }\n};",{"version":3,"sources":["image-upload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyBA,SAAA,YAAA,QAAA,oCAAA;AACA,OAAA,MAAA,MAAA,uBAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,kBADA;AAEA,EAAA,KAAA,EAAA,CAAA,MAAA,EAAA,OAAA,EAAA,QAAA,EAAA,KAAA,CAFA;AAIA,EAAA,IAJA,kBAIA;AACA,WAAA;AACA,MAAA,cAAA,EAAA,EADA;AAEA,MAAA,aAAA,EAAA,KAFA;AAGA,MAAA,QAAA,EAAA,CAAA,KAAA,KAAA,IAAA,EAAA,EAAA,GAAA,CAAA,UAAA,IAAA;AAAA,+CACA,IADA;AAEA,UAAA,GAAA,EAAA,IAAA,CAAA;AAFA;AAAA,OAAA,CAHA;AAOA,MAAA,OAAA,EAAA;AAPA,KAAA;AASA,GAdA;AAgBA,EAAA,QAAA,EAAA;AACA,IAAA,MADA,oBACA;AACA,UAAA,iBAAA,GAAA,CAAA,CAAA,KAAA,KAAA,CAAA,KAAA;AAEA,aACA,KAAA,GAAA,IACA,iBAAA,IACA,KAAA,KAAA,CAAA,KAAA,CAAA,WAAA,CAAA,MAAA,IACA,KAAA,GAHA,IAIA,CAAA,iBAAA,IACA,CAAA,KAAA,KAAA,IAAA,EAAA,EAAA,MAAA,IAAA,KAAA,GANA;AAQA,KAZA;AAcA,IAAA,MAdA,oBAcA;AACA,aAAA,SAAA;AACA;AAhBA,GAhBA;AAmCA,EAAA,OAAA,EAAA;AACA,IAAA,iBADA;AAAA,wGACA,OADA;AAAA;AAAA;AAAA;AAAA;AAEA,qBAAA,OAAA,GAAA,IAAA;AAFA,iDAGA,YAAA,CAAA,iBAAA,CACA,KAAA,IADA,EAEA,OAFA,EAGA,KAAA,MAHA,CAHA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAUA,IAAA,SAVA,qBAUA,IAVA,EAUA;AACA,UAAA,CAAA,IAAA,EAAA;AACA;AACA;;AAEA,WAAA,KAAA,CAAA,OAAA,+BAAA,KAAA,KAAA,IAAA,EAAA,IAAA,IAAA;AACA,WAAA,OAAA,GAAA,KAAA;AACA,KAjBA;AAmBA,IAAA,OAnBA,mBAmBA,KAnBA,EAmBA;AACA,MAAA,MAAA,CAAA,WAAA,CAAA,KAAA;AACA,WAAA,OAAA,GAAA,KAAA;AACA,KAtBA;AAwBA,IAAA,QAxBA,oBAwBA,IAxBA,EAwBA;AACA,UAAA,CAAA,IAAA,EAAA;AACA;AACA;;AAEA,UAAA,EAAA,GAAA,IAAA,CAAA,QAAA,GAAA,IAAA,CAAA,QAAA,CAAA,EAAA,GAAA,IAAA,CAAA,EAAA;AAEA,WAAA,KAAA,CACA,OADA,EAEA,CAAA,KAAA,KAAA,IAAA,EAAA,EAAA,MAAA,CACA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,EAAA,KAAA,EAAA;AAAA,OADA,CAFA;AAMA,KArCA;AAuCA,IAAA,wBAvCA,oCAuCA,IAvCA,EAuCA;AACA,WAAA,cAAA,GAAA,IAAA,CAAA,GAAA;AACA,WAAA,aAAA,GAAA,IAAA;AACA;AA1CA;AAnCA,CAAA","sourcesContent":["<template>\n  <div>\n    <el-upload\n      :accept=\"accept\"\n      :class=\"{ 'image-upload-hide-upload': isFull || loading }\"\n      :file-list=\"fileList\"\n      :http-request=\"uploadFromRequest\"\n      :on-error=\"onError\"\n      :on-preview=\"handlePictureCardPreview\"\n      :on-remove=\"onRemove\"\n      :on-success=\"onSuccess\"\n      action\n      list-type=\"picture-card\"\n      ref=\"files\"\n    >\n      <i class=\"el-icon-plus\"></i>\n    </el-upload>\n\n    <el-dialog :visible.sync=\"dialogVisible\">\n      <img :src=\"dialogImageUrl\" alt width=\"100%\">\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { FileUploader } from '@/shared/file-upload/file-uploader';\nimport Errors from '@/shared/error/errors';\n\nexport default {\n  name: 'app-image-upload',\n  props: ['path', 'value', 'schema', 'max'],\n\n  data() {\n    return {\n      dialogImageUrl: '',\n      dialogVisible: false,\n      fileList: (this.value || []).map((item) => ({\n        ...item,\n        url: item.publicUrl,\n      })),\n      loading: false,\n    };\n  },\n\n  computed: {\n    isFull() {\n      const hasInputReference = !!this.$refs.files;\n\n      return (\n        (this.max &&\n          (hasInputReference &&\n            this.$refs.files.uploadFiles.length >=\n              this.max)) ||\n        (!hasInputReference &&\n          (this.value || []).length >= this.max)\n      );\n    },\n\n    accept() {\n      return 'image/*';\n    },\n  },\n\n  methods: {\n    async uploadFromRequest(request) {\n      this.loading = true;\n      return FileUploader.uploadFromRequest(\n        this.path,\n        request,\n        this.schema,\n      );\n    },\n\n    onSuccess(file) {\n      if (!file) {\n        return;\n      }\n\n      this.$emit('input', [...(this.value || []), file]);\n      this.loading = false;\n    },\n\n    onError(error) {\n      Errors.showMessage(error);\n      this.loading = false;\n    },\n\n    onRemove(file) {\n      if (!file) {\n        return;\n      }\n\n      const id = file.response ? file.response.id : file.id;\n\n      this.$emit(\n        'input',\n        (this.value || []).filter(\n          (item) => item.id !== id,\n        ),\n      );\n    },\n\n    handlePictureCardPreview(file) {\n      this.dialogImageUrl = file.url;\n      this.dialogVisible = true;\n    },\n  },\n};\n</script>\n\n<style>\n.image-upload-hide-upload .el-upload--picture-card {\n  display: none !important;\n}\n</style>\n"],"sourceRoot":"src/shared/form"}]}