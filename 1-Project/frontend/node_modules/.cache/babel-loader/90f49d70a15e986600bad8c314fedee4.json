{"remainingRequest":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\babel-loader\\lib\\index.js!E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\Projects\\vue-library-master\\1-Project\\frontend\\src\\modules\\settings\\settings-service.js","dependencies":[{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\src\\modules\\settings\\settings-service.js","mtime":1641838498581},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\babel.config.js","mtime":1641838494433},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641838763341},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1641838769328},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\eslint-loader\\index.js","mtime":1641838766164}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"E:\\\\Projects\\\\vue-library-master\\\\1-Project\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport _classCallCheck from \"E:\\\\Projects\\\\vue-library-master\\\\1-Project\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";\nimport _createClass from \"E:\\\\Projects\\\\vue-library-master\\\\1-Project\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";\nimport authAxios from '@/shared/axios/auth-axios';\nimport AuthService from '@/modules/auth/auth-service';\nexport var SettingsService = /*#__PURE__*/function () {\n  function SettingsService() {\n    _classCallCheck(this, SettingsService);\n  }\n\n  _createClass(SettingsService, null, [{\n    key: \"fetchAndApply\",\n    value: function () {\n      var _fetchAndApply = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var settings;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                settings = null;\n                _context.prev = 1;\n                _context.next = 4;\n                return this.find();\n\n              case 4:\n                settings = _context.sent;\n                _context.next = 11;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](1);\n                AuthService.signout();\n                throw _context.t0;\n\n              case 11:\n                this.applyTheme(settings.theme);\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 7]]);\n      }));\n\n      function fetchAndApply() {\n        return _fetchAndApply.apply(this, arguments);\n      }\n\n      return fetchAndApply;\n    }()\n  }, {\n    key: \"find\",\n    value: function () {\n      var _find = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var response;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return authAxios.get(\"/settings\");\n\n              case 2:\n                response = _context2.sent;\n                return _context2.abrupt(\"return\", response.data);\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function find() {\n        return _find.apply(this, arguments);\n      }\n\n      return find;\n    }()\n  }, {\n    key: \"save\",\n    value: function () {\n      var _save = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(settings) {\n        var body, response;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                body = {\n                  settings: settings\n                };\n                _context3.next = 3;\n                return authAxios.put(\"/settings\", body);\n\n              case 3:\n                response = _context3.sent;\n                return _context3.abrupt(\"return\", response.data);\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function save(_x) {\n        return _save.apply(this, arguments);\n      }\n\n      return save;\n    }()\n  }, {\n    key: \"applyTheme\",\n    value: function applyTheme(color) {\n      var oldLink = document.getElementById('theme-link');\n      var link = document.createElement('link');\n      link.setAttribute('id', 'theme-link');\n      link.setAttribute('rel', 'stylesheet');\n      link.setAttribute('type', 'text/css');\n      link.setAttribute('href', \"\".concat(process.env.BASE_URL, \"theme/\").concat(color, \".css\"));\n\n      if (oldLink) {\n        document.getElementsByTagName('head').item(0).replaceChild(oldLink, link);\n      } else {\n        document.getElementsByTagName('head').item(0).appendChild(link);\n      }\n    }\n  }]);\n\n  return SettingsService;\n}();",{"version":3,"sources":["E:/Projects/vue-library-master/1-Project/frontend/src/modules/settings/settings-service.js"],"names":["authAxios","AuthService","SettingsService","settings","find","signout","applyTheme","theme","get","response","data","body","put","color","oldLink","document","getElementById","link","createElement","setAttribute","process","env","BASE_URL","getElementsByTagName","item","replaceChild","appendChild"],"mappings":";;;;;AAAA,OAAOA,SAAP,MAAsB,2BAAtB;AACA,OAAOC,WAAP,MAAwB,6BAAxB;AAEA,WAAaC,eAAb;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,mFACE;AAAA;AAAA;AAAA;AAAA;AAAA;AACMC,gBAAAA,QADN,GACiB,IADjB;AAAA;AAAA;AAAA,uBAGqB,KAAKC,IAAL,EAHrB;;AAAA;AAGID,gBAAAA,QAHJ;AAAA;AAAA;;AAAA;AAAA;AAAA;AAKIF,gBAAAA,WAAW,CAACI,OAAZ;AALJ;;AAAA;AAQE,qBAAKC,UAAL,CAAgBH,QAAQ,CAACI,KAAzB;;AARF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADF;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0EAYE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACyBP,SAAS,CAACQ,GAAV,aADzB;;AAAA;AACQC,gBAAAA,QADR;AAAA,kDAESA,QAAQ,CAACC,IAFlB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAZF;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0EAiBE,kBAAkBP,QAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AACQQ,gBAAAA,IADR,GACe;AACXR,kBAAAA,QAAQ,EAARA;AADW,iBADf;AAAA;AAAA,uBAKyBH,SAAS,CAACY,GAAV,cAA2BD,IAA3B,CALzB;;AAAA;AAKQF,gBAAAA,QALR;AAAA,kDAMSA,QAAQ,CAACC,IANlB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAjBF;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,WA0BE,oBAAkBG,KAAlB,EAAyB;AACvB,UAAMC,OAAO,GAAGC,QAAQ,CAACC,cAAT,CAAwB,YAAxB,CAAhB;AAEA,UAAMC,IAAI,GAAGF,QAAQ,CAACG,aAAT,CAAuB,MAAvB,CAAb;AACAD,MAAAA,IAAI,CAACE,YAAL,CAAkB,IAAlB,EAAwB,YAAxB;AACAF,MAAAA,IAAI,CAACE,YAAL,CAAkB,KAAlB,EAAyB,YAAzB;AACAF,MAAAA,IAAI,CAACE,YAAL,CAAkB,MAAlB,EAA0B,UAA1B;AACAF,MAAAA,IAAI,CAACE,YAAL,CACE,MADF,YAEKC,OAAO,CAACC,GAAR,CAAYC,QAFjB,mBAEkCT,KAFlC;;AAKA,UAAIC,OAAJ,EAAa;AACXC,QAAAA,QAAQ,CACLQ,oBADH,CACwB,MADxB,EAEGC,IAFH,CAEQ,CAFR,EAGGC,YAHH,CAGgBX,OAHhB,EAGyBG,IAHzB;AAID,OALD,MAKO;AACLF,QAAAA,QAAQ,CACLQ,oBADH,CACwB,MADxB,EAEGC,IAFH,CAEQ,CAFR,EAGGE,WAHH,CAGeT,IAHf;AAID;AACF;AAjDH;;AAAA;AAAA","sourcesContent":["import authAxios from '@/shared/axios/auth-axios';\nimport AuthService from '@/modules/auth/auth-service';\n\nexport class SettingsService {\n  static async fetchAndApply() {\n    let settings = null;\n    try {\n      settings = await this.find();\n    } catch (error) {\n      AuthService.signout();\n      throw error;\n    }\n    this.applyTheme(settings.theme);\n  }\n\n  static async find() {\n    const response = await authAxios.get(`/settings`);\n    return response.data;\n  }\n\n  static async save(settings) {\n    const body = {\n      settings,\n    };\n\n    const response = await authAxios.put(`/settings`, body);\n    return response.data;\n  }\n\n  static applyTheme(color) {\n    const oldLink = document.getElementById('theme-link');\n\n    const link = document.createElement('link');\n    link.setAttribute('id', 'theme-link');\n    link.setAttribute('rel', 'stylesheet');\n    link.setAttribute('type', 'text/css');\n    link.setAttribute(\n      'href',\n      `${process.env.BASE_URL}theme/${color}.css`,\n    );\n\n    if (oldLink) {\n      document\n        .getElementsByTagName('head')\n        .item(0)\n        .replaceChild(oldLink, link);\n    } else {\n      document\n        .getElementsByTagName('head')\n        .item(0)\n        .appendChild(link);\n    }\n  }\n}\n"]}]}