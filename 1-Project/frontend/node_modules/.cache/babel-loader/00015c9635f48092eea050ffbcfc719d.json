{"remainingRequest":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\babel-loader\\lib\\index.js!E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Projects\\vue-library-master\\1-Project\\frontend\\src\\shared\\form\\autocomplete-many-input.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\src\\shared\\form\\autocomplete-many-input.vue","mtime":1641838499507},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\babel.config.js","mtime":1641838494433},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641838763341},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1641838769328},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641838763341},{"path":"E:\\Projects\\vue-library-master\\1-Project\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1641838768457}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"E:\\\\Projects\\\\vue-library-master\\\\1-Project\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { debounce, isString } from 'lodash';\nexport default {\n  name: 'app-autocomplete-many-input',\n  props: {\n    value: {\n      type: Array\n    },\n    fetchFn: {\n      type: Function\n    },\n    clientSideSearch: {\n      type: Boolean,\n      default: false\n    },\n    disabled: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data: function data() {\n    return {\n      loading: false,\n      serverSideDataSource: [],\n      clientSideDataSource: [],\n      currentQuery: 'NOT_INITIALIZED',\n      debouncedSearch: function debouncedSearch() {}\n    };\n  },\n  mounted: function mounted() {\n    this.debouncedSearch = debounce(this.handleSearch.bind(this), 300); // Fetch first results\n\n    this.handleSearch('');\n  },\n  computed: {\n    initialOptions: function initialOptions() {\n      var _this = this;\n\n      if (!this.value || !this.value.length) {\n        return [];\n      }\n\n      return this.value.filter(function (currentValue) {\n        return !_this.dataSource.map(function (item) {\n          return item.id;\n        }).includes(currentValue.id);\n      });\n    },\n    dataSource: function dataSource() {\n      if (this.clientSideSearch) {\n        return this.clientSideDataSource;\n      }\n\n      return this.serverSideDataSource;\n    }\n  },\n  methods: {\n    onChange: function onChange(value) {\n      this.$emit('input', value || []);\n    },\n    handleSearch: function () {\n      var _handleSearch = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(value) {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (isString(value)) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 2:\n                if (!this.clientSideSearch) {\n                  _context.next = 4;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", this.handleSearchClient(value));\n\n              case 4:\n                return _context.abrupt(\"return\", this.handleSearchServer(value));\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function handleSearch(_x) {\n        return _handleSearch.apply(this, arguments);\n      }\n\n      return handleSearch;\n    }(),\n    handleSearchClient: function () {\n      var _handleSearchClient = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(value) {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(!this.serverSideDataSource || !this.serverSideDataSource.length)) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                _context2.next = 3;\n                return this.handleSearchServer();\n\n              case 3:\n                this.clientSideDataSource = this.serverSideDataSource.filter(function (item) {\n                  return String(item.label || '').toLowerCase().includes(String(value || '').toLowerCase());\n                });\n                this.loading = false;\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function handleSearchClient(_x2) {\n        return _handleSearchClient.apply(this, arguments);\n      }\n\n      return handleSearchClient;\n    }(),\n    handleSearchServer: function () {\n      var _handleSearchServer = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(value) {\n        var serverSideDataSource;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(value === this.currentQuery)) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\");\n\n              case 2:\n                this.currentQuery = value;\n                this.loading = true;\n                _context3.prev = 4;\n                _context3.next = 7;\n                return this.fetchFn(value, 10);\n\n              case 7:\n                serverSideDataSource = _context3.sent;\n\n                if (this.currentQuery === value) {\n                  this.serverSideDataSource = serverSideDataSource;\n                  this.loading = false;\n                }\n\n                _context3.next = 15;\n                break;\n\n              case 11:\n                _context3.prev = 11;\n                _context3.t0 = _context3[\"catch\"](4);\n                console.error(_context3.t0);\n\n                if (this.currentQuery === value) {\n                  this.serverSideDataSource = [];\n                  this.loading = false;\n                }\n\n              case 15:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[4, 11]]);\n      }));\n\n      function handleSearchServer(_x3) {\n        return _handleSearchServer.apply(this, arguments);\n      }\n\n      return handleSearchServer;\n    }()\n  }\n};",{"version":3,"sources":["autocomplete-many-input.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <el-select\n    :disabled=\"disabled\"\n    :loading=\"loading\"\n    :remote-method=\"handleSearch\"\n    :value=\"value\"\n    @change=\"onChange\"\n    clearable\n    default-first-option\n    filterable\n    multiple\n    placeholder\n    remote\n    reserve-keyword\n    value-key=\"id\"\n  >\n    <el-option\n      :key=\"initialOption.id\"\n      :label=\"initialOption.label\"\n      :value=\"initialOption\"\n      v-for=\"initialOption of initialOptions\"\n    ></el-option>\n    <el-option :key=\"record.id\" :label=\"record.label\" :value=\"record\" v-for=\"record in dataSource\"></el-option>\n  </el-select>\n</template>\n\n<script>\nimport { debounce, isString } from 'lodash';\n\nexport default {\n  name: 'app-autocomplete-many-input',\n\n  props: {\n    value: {\n      type: Array,\n    },\n    fetchFn: {\n      type: Function,\n    },\n    clientSideSearch: {\n      type: Boolean,\n      default: false,\n    },\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n  },\n\n  data() {\n    return {\n      loading: false,\n      serverSideDataSource: [],\n      clientSideDataSource: [],\n      currentQuery: 'NOT_INITIALIZED',\n      debouncedSearch: () => {},\n    };\n  },\n\n  mounted() {\n    this.debouncedSearch = debounce(\n      this.handleSearch.bind(this),\n      300,\n    );\n\n    // Fetch first results\n    this.handleSearch('');\n  },\n\n  computed: {\n    initialOptions() {\n      if (!this.value || !this.value.length) {\n        return [];\n      }\n\n      return this.value.filter(\n        (currentValue) =>\n          !this.dataSource\n            .map((item) => item.id)\n            .includes(currentValue.id),\n      );\n    },\n\n    dataSource() {\n      if (this.clientSideSearch) {\n        return this.clientSideDataSource;\n      }\n\n      return this.serverSideDataSource;\n    },\n  },\n\n  methods: {\n    onChange(value) {\n      this.$emit('input', value || []);\n    },\n\n    async handleSearch(value) {\n      if (!isString(value)) {\n        return;\n      }\n\n      if (this.clientSideSearch) {\n        return this.handleSearchClient(value);\n      }\n\n      return this.handleSearchServer(value);\n    },\n\n    async handleSearchClient(value) {\n      if (\n        !this.serverSideDataSource ||\n        !this.serverSideDataSource.length\n      ) {\n        await this.handleSearchServer();\n      }\n\n      this.clientSideDataSource = this.serverSideDataSource.filter(\n        (item) =>\n          String(item.label || '')\n            .toLowerCase()\n            .includes(String(value || '').toLowerCase()),\n      );\n\n      this.loading = false;\n    },\n\n    async handleSearchServer(value) {\n      if (value === this.currentQuery) {\n        return;\n      }\n\n      this.currentQuery = value;\n      this.loading = true;\n\n      try {\n        const serverSideDataSource = await this.fetchFn(\n          value,\n          10,\n        );\n        if (this.currentQuery === value) {\n          this.serverSideDataSource = serverSideDataSource;\n          this.loading = false;\n        }\n      } catch (error) {\n        console.error(error);\n\n        if (this.currentQuery === value) {\n          this.serverSideDataSource = [];\n          this.loading = false;\n        }\n      }\n    },\n  },\n};\n</script>\n\n<style>\n</style>\n"],"sourceRoot":"src/shared/form"}]}